## Transaction?

- 트랜잭션은 **데이터베이스의 상태를 변경 시키기 위해 수행하는** **작업 단위**입니다.
    - 데이터베이스의 상태를 변경 시킨다는 말은, SELECT, INSERT, UPDATE, DELETE와 같은 행동을 의미합니다.
- 트랜잭션은 작업의 완전성을 보장해줍니다.
- 논리적인 작업 셋을 모두 완벽하게 처리하거나 또는 처리하지 못할 경우에는 원 상태로 복구해서 작업의 일부만 적용되는 현상이 발생하지 않게 만들어주는 기능입니다.

## 트랜잭션의 특징(ACID)

- **A**tomicity(원자성)
    - 트랜잭션이 데이터베이스에 모두 반영되던지, 아니면 전혀 반영 되지 않아야 합니다.
    - 트랜잭션 내의 모든 명령은 반드시 완벽히 수행되어야 하며, 모두가 완벽히 수행되지 않고 어느 하나라도 오류가 발생하면 트랜잭션 전부가 취소되어야 합니다.
- **C**onsistency(일관성)
    - 트랜잭션의 작업 처리 결과가 항상 일관성이 있어야 합니다.
    - 데이터의 타입이 작업 전과 후 항상 동일해야합니다.
- **I**solation(독립성)
    - 둘 이상의 트랜잭션이 동시에 실행되고 있을 경우 어떤 하나의 트랜잭션이라도 다른 트랜잭션의 연산에 끼어들수 없습니다.
    - 수행 중인 트랜잭션은 완전히 완료될 때까지 다른 트랜잭션에서 수행 결과를 참조 할 수 없습니다.
- **D**urability(지속성)
    - 트랜잭션이 성공적으로 완료되었을 경우, 결과는 영구적으로 반영되어야 합니다.

## Transaction의 Commit과 Rollback

### Commit

- 하나의 트랜잭션이 성공적으로 끝나서 데이터베이스가 일관성있는 상태에 있음을 의미합니다.

### Rollback

- 트랜잭션의 원자성이 깨질때, 즉 하나의 트랜잭션 처리가 비정상적으로 종료되었을 때의 상태를 뜻합니다.
- 이 트랜잭션의 일부가 정상적으로 처리되었더라도 트랜잭션의 원자성을 구현하기 위해 이 트랜잭션이 행한 모든 연산을 취소(Undo)합니다.

![](https://img.notionusercontent.com/s3/prod-files-secure%2F560fc466-27da-429f-ba6b-9df88144a59a%2F7619e866-fa7a-41bf-8cd2-c6739aba2ec0%2FUntitled.png/size/w=2000?exp=1728905362&sig=qjdAH2-OlOa0or1ayXe0lbWf9X2VfiptSyc_z_2U3wo)
## **트랜잭션을 사용할 때 주의할 점**

- 트랜잭션은 꼭 필요한 최소의 코드에만 적용하는 것이 좋습니다.
    - 즉 트랜잭션의 범위를 최소화하라는 의미입니다.
- 일반적으로 데이터베이스 커넥션은 개수가 제한적입니다.
- 그런데 각 단위 프로그램이 커넥션을 소유하는 시간이 길어진다면 사용 가능한 여유 커넥션의 개수는 줄어들게 됩니다.
- 그러다 어느 순간에는 각 단위 프로그램에서 커넥션을 가져가기 위해 기다려야 하는 상황이 발생할 수도 있는 것입니다.

### [참고]

[https://code-lab1.tistory.com/51](https://code-lab1.tistory.com/51)

[https://coding-factory.tistory.com/226](https://coding-factory.tistory.com/226)

[https://wonit.tistory.com/462](https://wonit.tistory.com/462)